<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Mailbox Notification System - EEC 172 Final Project</title>
    <style>
        :root {
            --primary-color: #2a6496;
            --secondary-color: #f8f9fa;
            --text-color: #333;
            --accent-color: #17a2b8;
            --border-color: #dee2e6;
            --highlight-color: #e9f5f9;
            --state-border: #bed1e6;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: #f5f5f5;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: var(--primary-color);
            color: white;
            padding: 30px;
            text-align: center;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        h2 {
            color: var(--primary-color);
            margin: 25px 0 15px 0;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--border-color);
        }
        
        h3 {
            color: var(--accent-color);
            margin: 25px 0 15px 0;
            padding-bottom: 5px;
            border-bottom: 1px solid var(--border-color);
        }
        
        h4 {
            color: var(--primary-color);
            margin: 20px 0 10px 0;
        }
        
        p {
            margin-bottom: 15px;
        }
        
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }
        
        .author-info {
            font-style: italic;
            margin-top: 10px;
            color: white;
        }
        
        .video-container {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            height: 0;
            overflow: hidden;
            max-width: 100%;
            margin: 25px 0;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 8px;
        }
        
        .code-block {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid var(--accent-color);
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 15px 0;
        }
        
        ul, ol {
            margin-left: 25px;
            margin-bottom: 20px;
        }
        
        li {
            margin-bottom: 15px;
        }
        
        .hardware-components {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .component-card {
            background-color: var(--secondary-color);
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }
        
        .component-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .component-card h4 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        
        .footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
            color: #666;
        }
        
        /* New styling for state machine */
        .state-machine-list {
            list-style-type: none;
            margin: 30px 0;
            padding: 0;
        }
        
        .state-item {
            background-color: var(--highlight-color);
            border: 1px solid var(--state-border);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        .state-title {
            font-size: 1.2rem;
            color: var(--primary-color);
            margin-bottom: 15px;
            border-bottom: 1px solid var(--state-border);
            padding-bottom: 8px;
        }
        
        .state-section {
            margin: 10px 0;
        }
        
        .state-label {
            font-weight: bold;
            color: var(--accent-color);
            margin-right: 5px;
        }
        
        .challenge-item {
            background-color: var(--secondary-color);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .challenge-title {
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        
        .solution-text {
            margin-top: 10px;
            padding-left: 15px;
            border-left: 3px solid var(--accent-color);
        }
        
        .demo-list {
            background-color: var(--secondary-color);
            padding: 20px;
            border-radius: 8px;
        }
        
        .demo-list li {
            padding: 8px 0;
            border-bottom: 1px dashed var(--border-color);
        }
        
        .demo-list li:last-child {
            border-bottom: none;
        }
        
        .hardware-connection {
            line-height: 1.8;
        }
        
        @media (max-width: 768px) {
            .hardware-components {
                grid-template-columns: 1fr;
            }
            
            body {
                padding: 15px;
            }
            
            header {
                padding: 20px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .state-item {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Smart Mailbox Notification System</h1>
        <p>EEC 172 - Final Project</p>
        <div class="author-info">By Jinhao Liang & Hao Lu</div>
    </header>
    
    <div class="container">
        <h2>Project Description</h2>
        
        <h3>Overview</h3>
        <p>
            The Smart Mailbox Notification System is a standalone, interactive prototype designed to enhance home security and convenience. 
            The system automatically detects when new mail is delivered and when the mailbox door is accessed, notifying the user in real time via AWS IoT. 
            It uses multiple sensing devices—including an ultrasonic sensor to detect mail delivery and an IR sensor for door access via password input—and 
            provides immediate feedback through an OLED display that shows both status messages and the current internal temperature. 
            The project operates autonomously by booting directly from flash memory, and it uses a stepper motor-based combination lock to secure the mailbox.
        </p>
        
        <h3>Functional Specification</h3>
        <h4>State Machine Operation</h4>
        <p>The system operates as a state machine with the following states:</p>
        
        <ol class="state-machine-list">
            <li class="state-item">
                <div class="state-title">No Mail State</div>
                <div class="state-section">
                    <span class="state-label">Behavior:</span>
                    The system remains in a standby mode when no mail is detected. The ultrasonic sensor continuously monitors the mailbox, and the temperature sensor tracks internal conditions.
                </div>
                <div class="state-section">
                    <span class="state-label">Transition:</span>
                    When the ultrasonic sensor detects a change indicating mail delivery, the system transitions to the Get New Mail State.
                </div>
            </li>
            <li class="state-item">
                <div class="state-title">Get New Mail State</div>
                <div class="state-section">
                    <span class="state-label">Behavior:</span>
                    Once mail is detected, the system displays "New Mails" on the OLED while continuously showing the current temperature.
                </div>
                <div class="state-section">
                    <span class="state-label">Transition:</span>
                    This state persists until the user initiates a door-opening sequence.
                </div>
            </li>
            <li class="state-item">
                <div class="state-title">Door Opening State</div>
                <div class="state-section">
                    <span class="state-label">Behavior:</span>
                    When a user initiates a door-opening sequence using the IR remote, the OLED prompts for a password.
                </div>
                <div class="state-section">
                    <span class="state-label">Transitions:</span>
                    <ul>
                        <li>If the correct password is entered within three attempts, the system unlocks the mailbox, updates the display (e.g., "Door Opened"), and sends an AWS IoT notification.</li>
                        <li>After unlocking, a 20-second timer starts. If the user forgets to re-lock the mailbox door within this period, the system sends an AWS IoT notification alerting the user that the door remains open.</li>
                        <li>If incorrect inputs occur more than three times, the system triggers a security alert via AWS IoT, notifying the user of an attempted breach.</li>
                    </ul>
                </div>
            </li>
            <li class="state-item">
                <div class="state-title">Mail Reset State</div>
                <div class="state-section">
                    <span class="state-label">Behavior:</span>
                    After mail retrieval and the mailbox being closed, the system resets to display "No Mails" on the OLED.
                </div>
                <div class="state-section">
                    <span class="state-label">Transition:</span>
                    If the mailbox is left open (i.e., the "0" button is not pressed to secure it), an AWS IoT notification warns the user that the mailbox is not secured.
                </div>
            </li>
        </ol>
        
        <h3>Hardware Components</h3>
        <div class="hardware-components">
            <div class="component-card">
                <h4>CC3200 LaunchPad</h4>
                <p>Acts as the central controller, managing sensor inputs, processing the state machine, and handling communications with AWS IoT over Wi-Fi.</p>
            </div>
            <div class="component-card">
                <h4>Ultrasonic Sensor</h4>
                <p>Mounted on top of the mailbox to continuously measure distance. Triggered readings indicate mail delivery (a sudden drop in distance values).</p>
            </div>
            <div class="component-card">
                <h4>Temperature Sensor</h4>
                <p>Connected over the I2C bus, continuously polled for temperature readings. Temperature data is displayed on the OLED to inform the user of internal conditions.</p>
            </div>
            <div class="component-card">
                <h4>OLED Display</h4>
                <p>Uses the SPI interface for fast data communication. Displays status messages including "No Mails", "New Mails", password prompts, and door status updates.</p>
            </div>
            <div class="component-card">
                <h4>IR Sensor & Remote Controller</h4>
                <p>Used for interactive password input. The firmware reads IR signals to determine if the correct password is entered. The system allows up to three incorrect attempts before triggering a security notification.</p>
            </div>
            <div class="component-card">
                <h4>Stepper Motor Lock</h4>
                <p>Activated when the correct password is provided, unlocking the mailbox. Controlled by the CC3200 through a stepper motor driver circuit.</p>
            </div>
        </div>
        
        <h3>Software Implementation</h3>
        <p>
            The system's software implementation includes:
        </p>
        <ul>
            <li><strong>Boot and Initialization:</strong> On power-up, the CC3200 loads firmware from flash, initializes all peripherals, and enters the No Mail State.</li>
            <li><strong>State Machine:</strong> Implements the state transitions as described in the functional specification using interrupt routines and periodic sensor polling.</li>
            <li><strong>Sensor Data Processing:</strong> The ultrasonic sensor's readings are filtered to reduce false triggers, while temperature sensor data is periodically updated and shown on the OLED.</li>
            <li><strong>User Interaction:</strong> The IR sensor detects remote inputs that are matched against a stored password. Valid input activates the stepper motor, while too many invalid attempts trigger an AWS IoT alert.</li>
            <li><strong>AWS IoT Communication:</strong> The integrated Wi-Fi module connects to AWS IoT. Different system states (mail delivery, door opening, security alerts, door left open, and forgotten locks) prompt the firmware to send corresponding notifications to the cloud.</li>
        </ul>
        
        <h3>Challenges and Solutions</h3>
        <p>
            During the implementation, several challenges were encountered and overcome:
        </p>
        <div class="challenge-list">
            <div class="challenge-item">
                <div class="challenge-title">Sensor Noise and False Positives</div>
                <p>The ultrasonic sensor initially produced noisy readings, leading to false mail delivery triggers.</p>
                <div class="solution-text">
                    <em>Solution:</em> Implemented software filtering and calibration routines to distinguish between actual mail delivery and ambient fluctuations.
                </div>
            </div>
            
            <div class="challenge-item">
                <div class="challenge-title">IR Input Handling and Integration</div>
                <p>Combining IR remote inputs with AWS function calls to trigger different messages and update the OLED display proved challenging.</p>
                <p><em>Issues Faced:</em> IR signals needed to be accurately interpreted to initiate specific AWS notifications and update the display accordingly. To correctly and responsively receive the IR input signals, it was necessary to implement flags that temporarily halted other sensor operations—ensuring accurate signal processing and preventing interference.</p>
                <div class="solution-text">
                    <em>Solution:</em> Adjusted IR sensor sensitivity, implemented a debouncing algorithm, and enhanced code logic with flag controls so that the IR inputs integrated seamlessly with AWS functions and OLED updates.
                </div>
            </div>
            
            <div class="challenge-item">
                <div class="challenge-title">Stepper Motor Integration and Precision</div>
                <p>Integrating the stepper motor was particularly challenging because the motor was originally designed for Arduino boards. Converting the existing library code from C++ to C for compatibility with the CC3200 required significant effort. Additionally, ensuring that the stepper motor correctly aligned with the lock mechanism was difficult.</p>
                <div class="solution-text">
                    <em>Solution:</em> Through iterative testing and refinement of the motor control timing—along with careful debugging of hardware interfacing issues—we achieved reliable operation of the stepper motor on the CC3200 platform and proper alignment with the lock mechanism.
                </div>
            </div>
            
            <div class="challenge-item">
                <div class="challenge-title">Wi-Fi Connectivity</div>
                <p>Intermittent connectivity affected real-time notifications via AWS IoT.</p>
                <div class="solution-text">
                    <em>Solution:</em> Integrated robust error handling and retry logic to ensure that notifications were sent reliably despite connection issues.
                </div>
            </div>
        </div>
        
        <h3>Future Work</h3>
        <p>
            Potential enhancements to the system include:
        </p>
        <ul>
            <li><strong>Enhanced Security:</strong> Integrate a camera module for visual confirmation of mail delivery or unauthorized access.</li>
            <li><strong>Advanced User Interface:</strong> Develop a mobile app for real-time status monitoring and control.</li>
            <li><strong>Voice Recognition:</strong> Add voice command capabilities to unlock the mailbox.</li>
            <li><strong>Data Analytics:</strong> Implement a logging system to analyze mail delivery patterns over time for predictive maintenance.</li>
        </ul>
    </div>
    
    <div class="container">
        <h2>Video Demo</h2>
        <p>
            The following video demonstrates the key features and functionality of the Smart Mailbox Notification System:
            (Please watch the video in full screen mode for better experience)
        </p>
        
        <div class="video-container">
            <video controls style="width:100%; border-radius:8px;" poster="optional_thumbnail.jpg">
                <source src="Product_Demo.mp4" type="video/mp4">
                
            </video>
        </div>
        
        <p>
            The video showcases:
        </p>
        <ol class="demo-list">
            <li>System initialization and boot-up process</li>
            <li>Mail detection demonstration using the ultrasonic sensor</li>
            <li>AWS IoT notification system in action</li>
            <li>Password entry via IR remote controller</li>
            <li>Temperature monitoring on the OLED display</li>
            <li>Stepper motor lock mechanism operation</li>
            <li>Security alerts for incorrect password attempts</li>
            <li>(There should be a 20-second timer for door left open notifications functionality when the door is left open, but we missed it in the video)</li>
        </ol>
    </div>
    
    <div class="container">
        <h2>Technical Documentation</h2>
        
        <h3>Hardware Setup</h3>
        <p>
            The Smart Mailbox hardware connections are as follows:
        </p>
        <div class="code-block hardware-connection">
            <strong>CC3200 LaunchPad:</strong><br>
            - OLED Display: Connected via SPI interface for status display<br>
            - Temperature Sensor: Connected via I2C bus for environmental monitoring<br>
            - Ultrasonic Sensor: Connected to GPIO pins for mail detection<br>
            - IR Sensor: Connected to GPIO for receiving password input from remote controller<br>
            - Stepper Motor: Connected through a stepper motor driver circuit for lock mechanism control
        </div>
        
        <h3>Bill of Materials</h3>
        <table style="width:100%; border-collapse:collapse; margin:20px 0; box-shadow: 0 2px 3px rgba(0,0,0,0.1);">
            <thead style="background-color:var(--primary-color); color:white;">
                <tr>
                    <th style="padding:12px; text-align:left; border:1px solid #ddd;">Component</th>
                    <th style="padding:12px; text-align:center; border:1px solid #ddd;">Quantity</th>
                </tr>
            </thead>
            <tbody>
                <tr style="background-color:#f2f2f2;">
                    <td style="padding:12px; border:1px solid #ddd;">CC3200 LaunchPad</td>
                    <td style="padding:12px; text-align:center; border:1px solid #ddd;">1</td>
                </tr>
                <tr>
                    <td style="padding:12px; border:1px solid #ddd;">Ultrasonic Sensor (HC-SR04)</td>
                    <td style="padding:12px; text-align:center; border:1px solid #ddd;">1</td>
                </tr>
                <tr style="background-color:#f2f2f2;">
                    <td style="padding:12px; border:1px solid #ddd;">OLED Display (SPI)</td>
                    <td style="padding:12px; text-align:center; border:1px solid #ddd;">1</td>
                </tr>
                <tr>
                    <td style="padding:12px; border:1px solid #ddd;">IR Remote Controller</td>
                    <td style="padding:12px; text-align:center; border:1px solid #ddd;">1</td>
                </tr>
                <tr style="background-color:#f2f2f2;">
                    <td style="padding:12px; border:1px solid #ddd;">Temperature Sensor (I2C)</td>
                    <td style="padding:12px; text-align:center; border:1px solid #ddd;">1</td>
                </tr>
                <tr>
                    <td style="padding:12px; border:1px solid #ddd;">Stepper Motor</td>
                    <td style="padding:12px; text-align:center; border:1px solid #ddd;">1</td>
                </tr>
            </tbody>
        </table>
        
        <h3>State Machine Diagram</h3>
        <p>
            The system operates according to the following state machine diagram:
        </p>
        <div style="text-align:center; margin:25px 0; padding: 20px; background-color: var(--secondary-color); border-radius: 8px;">
            <img src="state_machine_diagram.png" alt="State Machine Diagram" style="max-width:100%; height:auto; border-radius:5px;">
        </div>
        
        <h3>Architectural Block Diagram</h3>
        <p>
            The architectural structure of the Smart Mailbox system:
        </p>
        <div style="text-align:center; margin:25px 0; padding: 20px; background-color: var(--secondary-color); border-radius: 8px;">
            <img src="architectural_block_diagram.png" alt="State Machine Diagram" style="max-width:100%; height:auto; border-radius:5px;">
        </div>

        <h3>Product Photo</h3>
        <p>
            The final product of the Smart Mailbox system:
        </p>
        <div style="text-align:center; margin:25px 0; padding: 20px; background-color: var(--secondary-color); border-radius: 8px;">
            <img src="Product1.png" alt="State Machine Diagram" style="max-width:100%; height:auto; border-radius:5px;">
            <img src="Product2.png" alt="State Machine Diagram" style="max-width:100%; height:auto; border-radius:5px;">
            <img src="Product3.png" alt="State Machine Diagram" style="max-width:100%; height:auto; border-radius:5px;">
        </div>


    </div>
    
    <div class="footer">
        <p>EEC 172 - Final Project &copy; 2024</p>
    </div>
</body>
</html>